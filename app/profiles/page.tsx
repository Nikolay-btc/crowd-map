"use client";\nimport React, { useEffect, useMemo, useState } from "react";\nimport ProfileModal, { User } from "@/components/ProfileModal";\nimport safeJson from "@/lib/safeJson";\n\nexport default function ProfilesPage(){\n  const [users, setUsers] = useState<User[]>([]);\n  const [query, setQuery] = useState("");\n  const [selected, setSelected] = useState<User|null>(null);\n  const filtered = useMemo(()=>{\n    const q = query.trim().toLowerCase();\n    if(!q) return users;\n    return users.filter(u => u.name.toLowerCase().includes(q));\n  }, [users, query]);\n\n  useEffect(() => {\n    (async () => {\n      const data = await safeJson<{users: any[]}>("/users.json", {users: []});\n      const mapped: User[] = (data.users||[]).map((u:any) => ({ id: u.id, name: u.name, photo: u.photo, rating: u.rating }));\n      setUsers(mapped);\n    })();\n    const rer = () => setUsers(prev=>[...prev]);\n    (document as any).addEventListener("profile:changed", rer);\n    return () => (document as any).removeEventListener("profile:changed", rer);\n  }, []);\n\n  return (\n    <main style={{ display: "grid", gridTemplateRows: "auto 1fr", height: "100vh" }}>\n      <header style={{ padding: 12, borderBottom: "1px solid #eee", display: "flex", gap: 8, alignItems: "center" }}>\n        <strong style={{ fontSize: 18 }}>??????? (????)</strong>\n        <input placeholder=\"????? ?? ?????\" value={query} onChange={e=>setQuery(e.target.value)} style={{ marginLeft: "auto", border: "1px solid #ddd", borderRadius: 8, padding: "8px 10px", width: 280 }} />\n      </header>\n      <section style={{ padding: 16, overflow: "auto" }}>\n        <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fill, minmax(180px, 1fr))", gap: 12 }}>\n          {filtered.map(u => (\n            <div key={u.id} style={{ border: "1px solid #eee", borderRadius: 12, padding: 12, display: "grid", gap: 8 }}>\n              <img src={u.photo} alt={u.name} width={160} height={160} style={{ width: "100%", height: 160, objectFit: "cover", borderRadius: 10, cursor: "pointer" }} onClick={()=>setSelected(u)} />\n              <div style={{ display: "flex", alignItems: "center", justifyContent: "space-between" }}>\n                <div style={{ fontWeight: 700 }}>{u.name}</div>\n                {typeof u.rating === "number" && <span style={{ fontSize: 12, opacity: .7 }}>{u.rating.toFixed(1)}</span>}\n              </div>\n              <button onClick={()=>setSelected(u)} style={{ border: "1px solid #ddd", borderRadius: 8, padding: "8px 10px", cursor: "pointer", background: "white" }}>??????? ???????</button>\n            </div>\n          ))}\n          {filtered.length === 0 && (<div style={{ opacity: .7 }}>?????? ?? ?????.</div>)}\n        </div>\n      </section>\n      {selected && <ProfileModal user={selected} onClose={()=>setSelected(null)} />}\n    </main>\n  );\n}\n